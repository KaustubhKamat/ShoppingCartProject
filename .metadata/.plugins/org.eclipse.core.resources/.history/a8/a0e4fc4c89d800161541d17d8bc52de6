<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
<div class="container maincontainer">
    <div class="row">
        <div class="col-md-9">
            <h1>Admin Management</h1>
            <p>Here you can manage your site.</p>


            <%-- category list is requested --%>
            <c:if test="${!empty categoryList}">
                    <h2>Category List</h2>
                    <table class="table">
                        <tr>
                            <th>Category Id:</th>
                            <th>Category Name:</th>
                        </tr>
                        <c:forEach var="category" items="${categoryList}" varStatus="iter">
                            <tr>
                            <td>${category.id}</td>
                            <td>${category.name}</td>

                            </tr>
                        </c:forEach>
                    </table>
            </c:if>

            <%-- customerList is requested --%>
            <c:if test="${!empty customerList}">
                    <table class="table">
                        <tr>
                            <th colspan="5">Customers</th>
                        </tr>
                        <tr>
                            <td>Customer Id</td>
                            <td>Name</td>
                            <td>Email</td>
                            <td>Phone</td>
                            <td>Address</td>
                        </tr>
                        <c:forEach var="customer" items="${customerList}" varStatus="iter">
                            <tr onclick="document.location.href='customerRecord?${customer.id}'">
                                <td class="green"><a href="customerRecord?${customer.id}">${customer.id}</a></td>
                                <td class="green"><a href="customerRecord?${customer.id}">${customer.name}</a></td>
                                <td class="green"><a href="customerRecord?${customer.id}">${customer.email}</a></td>
                                <td class="green"><a href="customerRecord?${customer.id}">${customer.phone}</a></td>
                                <td class="green"><a href="customerRecord?${customer.id}">${customer.address}</a></td>
                            </tr>
                        </c:forEach>

                    </table>
            </c:if>
            <%-- orderList is requested --%>
            <c:if test="${!empty orderList}">
                <table class="table">
                    <tr class="header">
                        <th colspan="4">Order List</th>
                    </tr>
                    <tr class="tableHeading">
                        <td>Order Id:</td>
                        <td>Confirmation No:</td>
                        <td>Amount</td>
                        <td>Date created</td>
                    </tr>
                    <c:forEach var="order" items="${orderList}" varStatus="iter">
                        <tr onclick="document.location.href='orderRecord?${order.id}'">
                            <td class="green"><a href="orderRecord?${order.id}" >${order.id}</a></td>
                            <td class="green"><a href="orderRecord?${order.id}" >${order.confirmationNumber}</a></td>
                            <td class="green"><a href="orderRecord?${order.id}" >
                            <fmt:formatNumber type="currency"
                                          currencySymbol="Rs. "
                                          value="${order.amount}"/></a></td>

                            <td class="green"><a href="orderRecord?${order.id}" >
                        <fmt:formatDate value="${order.dateCreated}"
                                        type="both"
                                        dateStyle="short"
                                        timeStyle="short"/></a></td>
                        </tr>
                    </c:forEach>
                </table>
            </c:if>

            <%-- customerRecord is requested --%>
            <c:if test="${!empty customerRecord}">
                <table class="table">
                    <tr class="header">
                        <th colspan="2">Customer Details</th>
                    </tr>
                    <tr>
                        <td style="width: 290px"><strong>Customer id:</strong></td>
                        <td>${customerRecord.id}</td>
                    </tr>
                    <tr>
                        <td><strong>Name:</strong></td>
                        <td>${customerRecord.name}</td>
                    </tr>
                    <tr>
                        <td><strong>Email:</strong></td>
                        <td>${customerRecord.email}</td>
                    </tr>
                    <tr>
                        <td><strong>Phone:</strong></td>
                        <td>${customerRecord.phone}</td>
                    </tr>
                    <tr>
                        <td><strong>Address:</strong></td>
                        <td>${customerRecord.address}</td>
                    </tr>
                    <tr>
                        <td><strong>City / Region:</strong></td>
                        <td>${customerRecord.cityRegion}</td>
                    </tr>
                    <tr><td colspan="2" style="padding: 0 20px"><hr></td></tr>
                    <tr onclick="document.location.href='orderRecord?${order.id}'">
                        <td colspan="2" class="green">
                        <a href="orderRecord?${order.id}">
                        <strong>View Order Summary</strong></a>
                        </td>
                    </tr>
                </table>
            </c:if>

            <%-- orderRecord is requested --%>
            <c:if test="${!empty orderRecord}">

                <table class="table">

                    <tr class="header">
                        <th colspan="3">Order Summary</th>
                    </tr>
                    <tr>
                        <td><strong>order id:</strong></td>
                        <td>${orderRecord.id}</td>
                    </tr>
                    <tr>
                        <td><strong>Confirmation No :</strong></td>
                        <td>${orderRecord.confirmationNumber}</td>
                    </tr>
                    <tr>
                        <td><strong>Date Processed:</strong></td>
                        <td>
                            <fmt:formatDate value="${orderRecord.dateCreated}"
                                            type="both"
                                            dateStyle="short"
                                            timeStyle="short"/></td>
                    </tr>

                    <tr>
                        <td colspan="2">
                            <table class="table tablein">
                               <tr class="">
                                    <td class="rigidWidth">Product</td>
                                    <td class="rigidWidth">Quantity</td>
                                    <td>Price</td>
                                </tr>

                                <tr><td colspan="3" ><hr></td></tr>

                                <c:forEach var="orderedProduct" items="${orderedProducts}" varStatus="iter">

                                    <tr>
                                        <td>
                                            ${products[iter.index].name} 
                                        </td>
                                        <td>
                                              ${orderedProduct.quantity}
                                        </td>
                                        <td class="confirmationPriceColumn">
                                            <fmt:formatNumber type="currency" currencySymbol="Rs. "
                                                              value="${products[iter.index].price * orderedProduct.quantity}"/>
                                        </td>
                                    </tr>

                                </c:forEach>

                                <tr><td colspan="3" style="padding: 0 20px"><hr></td></tr>

                                <tr>
                                    <td colspan="2" id="deliverySurchargeCellLeft"><strong>Delivery Charge:</strong></td>
                                    <td id="deliverySurchargeCellRight">
                                        <fmt:formatNumber type="currency"
                                                          currencySymbol="Rs. "
                                                          value="${initParam.deliverySurcharge}"/></td>
                                </tr>

                                <tr>
                                    <td colspan="2" id="totalCellLeft"><strong>Total Amount:</strong></td>
                                    <td id="totalCellRight">
                                        <fmt:formatNumber type="currency"
                                                          currencySymbol="Rs. "
                                                          value="${orderRecord.amount}"/></td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <tr><td colspan="3" style="padding: 0 20px"><hr></td></tr>

                    <tr 
                        onclick="document.location.href='customerRecord?${customer.id}'">
                        <td colspan="2" class="green">

                            <a href="customerRecord?${customer.id}" >
                                <strong>View Customer Details </strong></a>
                        </td>
                    </tr>
                </table>

            </c:if>




        </div>

    <div class="col-md-3">
            <h1>Admin Menu</h1>
            <p class ="admin"><a href="<c:url value='showCategory'/>">View Category</a></p>
            <p class ="admin"><a href="<c:url value='addCategory.jsp'/>">Add Category</a></p>
            <p class ="admin"><a href="<c:url value='upload.jsp'/>">Upload Category Image</a></p>
            <p class ="admin"><a href="<c:url value='addProduct.jsp'/>">Add Product</a></p>
            <p class ="admin"><a href="<c:url value='viewCustomers'/>">View All Customers</a></p>                        
            <p class ="admin"><a href="<c:url value='viewOrders'/>">View All Orders</a></p>
            <p class ="admin"><a href="<c:url value='logout'/>">Log Out</a></p>       
    </div>
    </div>

</div>
<!-- main container ends here -->
<div class="pullfooter"></div>

<div class ="jumbotron">
<p>Jumbo</p>

</div>
<div class="pullfooter"></div>
</body>
</html>
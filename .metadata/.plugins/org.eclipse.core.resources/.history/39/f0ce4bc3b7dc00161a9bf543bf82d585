package com.niit.shoppingcart.DAOImpl;

import com.niit.shoppingcart.DAO.Employee_TestDAO;

public class Employee_TestDAOImpl implements Employee_TestDAO {

	@Autowired
	 SessionFactory sessionFactory;

	 @Override
	 @Transactional
	 public int insertRow(Employee employee) {
	  Session session = sessionFactory.openSession();
	  Transaction tx = session.beginTransaction();
	  session.saveOrUpdate(employee);
	  tx.commit();
	  Serializable id = session.getIdentifier(employee);
	  session.close();
	  return (Integer) id;
	 }

	 @Override
	 public List getList() {
	  Session session = sessionFactory.openSession();
	  @SuppressWarnings("unchecked")
	  List employeeList = session.createQuery("from Employee")
	    .list();
	  session.close();
	  return employeeList;
	 }

	 @Override
	 public Employee getRowById(int id) {
	  Session session = sessionFactory.openSession();
	  Employee employee = (Employee) session.load(Employee.class, id);
	  return employee;
	 }

	 @Override
	 public int updateRow(Employee employee) {
	  Session session = sessionFactory.openSession();
	  Transaction tx = session.beginTransaction();
	  session.saveOrUpdate(employee);
	  tx.commit();
	  Serializable id = session.getIdentifier(employee);
	  session.close();
	  return (Integer) id;
	 }

	 @Override
	 public int deleteRow(int id) {
	  Session session = sessionFactory.openSession();
	  Transaction tx = session.beginTransaction();
	  Employee employee = (Employee) session.load(Employee.class, id);
	  session.delete(employee);
	  tx.commit();
	  Serializable ids = session.getIdentifier(employee);
	  session.close();
	  return (Integer) ids;
	 }

	}


